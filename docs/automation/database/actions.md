---
title: 'Automation: Действия'
---

# Automation: Действия

## Действие `property`

Это действие управляет выбранным свойством, то есть отправляет команду устройству.

Примеры описания действия:

```json
...
"actions":
[
  {
    "type": "property",
    "endpoint": "zigbee/kitchenLight",
    "property": "level",
    "increase": 10
  },
  {
    "type": "property",
    "endpoint": "zigbee/roomCurtain",
    "property": "position",
    "decrease": 25
  },
  {
    "type": "property",
    "endpoint": "zigbee/hallLight",
    "property": "status",
    "value": "off"
  }
]
...
```

!!! warning ""

    Поля `increase`, `decrease`, `value` не могут использоваться в одном действии одновременно.

### `endpoint`

<!-- TODO: дать корректное описание -->

Конечная точка, которой управляет действие. Описывается в формате `service/device` или `service/device/N`, где `N` это номер конечной точки для многоканальных устройств.

По сути, значение этого поля явдяется частью топика [`td`](/common/topics/#td-to-device), отностящейся к конкретному устройству.

### `property`

Свойство конечной точки, которым управляет действие. Другими словами - название поля в сообщении с командой.

### `increase`

В команде будет передано _числовое_ значение свойства, увеличенное на значение этого поля.

### `decrease`

В команде будет передано _числовое_ значение свойства, уменьшенное на значение этого поля.

### `value`

Конкретное значение свойства, передаваемое в команде. Может содержать [шаблоны](/automation/patterns/).

## Действие `mqtt`

Это действие отправляет сообщение в заданный MQTT-топик.

Примеры описания действия:

```json
...
"actions":
[
  {
    "type": "mqtt",
    "topic": "my/action/topic",
    "message": "hello world"
  },
  {
    "type": "mqtt",
    "topic": "other/topic",
    "message": "retained message",
    "retain": true
  }
]
...
```

### `topic`

MQTT-топик.

### `message`

Текст отправляемого сообщения. Может содержать [шаблоны](/automation/patterns/).

### `retain`

Отправка сообщения с флагом ___retain___.

## Действие `state`

Это действие позволяет устанавливать или удалять [состояния](/automation/database/#_4).

Примеры описания действий:

```json
...
"actions":
[
  {
    "type": "state",
    "name": "myFavoriteState",
    "value": true
  },
  {
    "type": "state",
    "name": "otherState",
    "value": "hello there"
  },
  {
    "type": "state",
    "name": "uselessState"
  }
]
...
```

### `name`

Название состояния.

### `value`

Значение состояния, устанавливаемое действием. Может содержать [шаблоны](/automation/patterns/).

Если это поле остутствует или равно `null`, состояние будет удалено.

## Действие `telegram`

Это действие отправляет текстовое сообщение с помощью Telegram-бота.

Примеры описания действия:

```json
...
"actions":
[
  {
    "type": "telegram",
    "message": "свет в гараже выключен",
    "silent": true
  },
  {
    "type": "telegram",
    "message": "входная дверь открыта!",
    "chats": [123456789, 4815162342]
  }
]
...
```

### `message`

Текст отправляемого сообщения. Может содержать [шаблоны](/automation/patterns/).

### `silent`

Отправка сообщения с уведомлением без звука.

### `chats`

Массив идентификаторов чатов, в которые будет отправлено сообщение. В случае отсутствия этого поля, сообщение будет отправлено в чат, идентификатор которого указан в [конфигурации](/automation/configuration/).

<!-- TODO: добавить описание остальых функций действия "telegram" -->

## Действие `shell`

Это действие запускает заданную shell-команду.

Пример описания действия:

```json
...
"actions":
[
  {
    "type": "shell",
    "command": "sh /home/user/script.sh"
  }
]
...
```

### `command`

Shell-команда, которая будет запущена. Может содержать [шаблоны](/automation/patterns/).

Команда может быть полноценным shell-скриптом, начинающимся с заголовка `#!`, в этом случае так же допустимо использование шаблонов.

## Действие `condition`

Это действие является контейнером для других действий, которые будут выполнены при соблюдении или несоблюдении заданных [условий](/automation/database/conditions/).

Пример описания действия:

```json
...
"actions":
[
  {
    "type": "condition",
    "conditions":
    [
       {
         "type": "date",
         ...
       },
       {
         "type": "time",
         ...
       }
    ],
    "then":
    [
       {
         "type": "property",
         ...
       }
    ],
    "else":
    [
       {
         "type": "telegram",
         ...
       }
    ]
  }
]
...
```

### `conditions`

Массив условий.

### `then`

Массив действий, которые будут выполнены, если условия соблюдены.

### `else`

Массив действий, которые будут выполнены, если условия _не_ соблюдены.

## Действие `delay`

Это действие добавляет задержку перед выполнением следующего по списку действия.

Пример описания действия:

```json
...
"actions":
[
  {
    "type": "delay",
    "delay": 10
  }
]
...
```

### `delay`

Время задержки в секундах.

## Действие `exit`

Это действие прерывает выполнение автоматизации.

Пример описания действия:

```json
...
"actions":
[
  {
    "type": "exit"
  }
]
...
```

## Дополнительные условия

Условия для выполнения действий могут определяться не тольлько специальным действием [`condition`](#condition), а так же тем, какой конкретно триггер вызвал срабатывание автоматизации, при условии, что для триггеров заданы [имена](/automation/database/triggers/#_2).

В этом случае нужные действия будут выполнены только в случае срабатывании соответсвующего им триггера, например:

```json
...
"actions":
[
  {
    "type": "property",
    "triggerName": "a",
    ...
  },
  {
    "type": "telegram",
    "triggerName": "b",
    ...
  }
]
...
```
